import{j as s}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.BVOCwoKb.js";import{c as b,o as j,g as N,P as G}from"./PieChart.CUJsZ-LB.js";import{u as y,G as E}from"./GastosContext.BTDxljjR.js";import{u as C}from"./useCurrency.D8rWf9GG.js";import"./supabase.4P1wv7wr.js";import"./LoadingSpinner.D7PxHcXC.js";const P=()=>{const{gastos:n}=y(),{formatCurrency:h}=C(),l=c.useRef(null),[o,d]=c.useState(null),m=c.useMemo(()=>{const e=[...n];return o&&o.monto&&o.monto>0&&o.mes&&e.push(o),b(e)},[n,o]),p=Object.entries(m).sort(([,e],[,t])=>t-e),v=Object.values(m).reduce((e,t)=>e+t,0),g=(e,t,a)=>{const r=j(e);return N(r,t,a)},i=()=>{const e=l.current;if(!e)return;const t=e.getContext("2d");t&&t.clearRect(0,0,e.width,e.height)};return c.useEffect(()=>{i();const e=()=>{d(null),i()},t=r=>{d(null),i()},a=r=>{d(r.detail),i()};return window.addEventListener("nuevoGasto",e),window.addEventListener("gastoEliminado",t),document.addEventListener("gastoPreview",a),()=>{window.removeEventListener("nuevoGasto",e),window.removeEventListener("gastoEliminado",t),document.removeEventListener("gastoPreview",a)}},[n,o]),s.jsxs("div",{className:"bg-white shadow rounded-lg p-2 sm:p-4 md:p-6",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4 md:mb-6",children:"Gastos por Mes"}),s.jsx("div",{className:"relative w-full aspect-[4/3] max-w-[600px] mx-auto",children:s.jsx("canvas",{ref:l,className:"absolute inset-0 w-full h-full"})}),s.jsx("div",{className:"space-y-2 sm:space-y-3 md:space-y-4 mt-3 sm:mt-4 md:mt-6",children:p.map(([e,t],a)=>{const r=(t/v*100).toFixed(1),u=n.filter(f=>f.mes===e),x=g(e,a,u.length),w=o&&o.mes===e;return s.jsxs("div",{className:`flex items-center justify-between p-2 sm:p-3 md:p-4 rounded-lg transition-all ${w?"bg-indigo-50 border border-indigo-100":"bg-gray-50"}`,style:{backgroundColor:x},children:[s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 min-w-0",children:[s.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 rounded-full flex-shrink-0",style:{backgroundColor:x}}),s.jsx("span",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:e})]}),s.jsxs("div",{className:"text-right ml-2",children:[s.jsx("div",{className:"font-medium text-gray-900 text-sm sm:text-base whitespace-nowrap",children:h(t)}),s.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 whitespace-nowrap",children:[r,"%"]})]})]},e)})})]})},T=()=>s.jsx(E,{children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Distribuci√≥n por Mes"}),s.jsx(G,{})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:s.jsx(P,{})})]})});export{T as default};
