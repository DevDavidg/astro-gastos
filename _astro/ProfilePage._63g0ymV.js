import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.BVOCwoKb.js";import{s as o}from"./supabase.4P1wv7wr.js";import p from"./LoadingSpinner.D7PxHcXC.js";function w(){const[i,c]=t.useState(null),[d,x]=t.useState([]),[f,n]=t.useState(!0),[m,u]=t.useState(null);t.useEffect(()=>{(async()=>{try{const{data:{user:r}}=await o.auth.getUser();c(r),r?h(r):n(!1)}catch(r){console.error("Error fetching user:",r),u(r instanceof Error?r.message:"An error occurred"),n(!1)}})();const{data:{subscription:a}}=o.auth.onAuthStateChange((r,l)=>{c(l?.user||null),l?.user?h(l.user):n(!1)});return()=>a.unsubscribe()},[]);async function h(s){try{const{data:a,error:r}=await o.from("personas").select("*").eq("usuarioid",s.id);if(r)throw r;x(a||[])}catch(a){console.error("Error loading personas:",a),u(a.message)}finally{n(!1)}}const g=async()=>{try{await o.auth.signOut(),window.location.href="/auth"}catch(s){console.error("Error signing out:",s)}};return f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(p,{size:"large",color:"primary"})}):i?e.jsx("div",{className:"max-w-4xl mx-auto p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mi Perfil"}),e.jsx("button",{onClick:g,className:"bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded",children:"Cerrar sesión"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Información de usuario"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",i?.email]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Personas"}),m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:m})}),d.length===0?e.jsx("p",{className:"text-gray-500",children:"No hay personas registradas."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h3",{className:"font-medium text-lg",children:s.nombre}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Sueldo:"})," $",s.sueldo.toLocaleString()]})]},s.id))})]})]})}):(window.location.href="/auth",null)}export{w as default};
