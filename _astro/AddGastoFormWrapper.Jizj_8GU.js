import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BVOCwoKb.js";import{u as j,G as y}from"./GastosContext.3YBrr_wS.js";import w from"./LoadingSpinner.D7PxHcXC.js";import"./supabase.4P1wv7wr.js";const P=({value:a,onChange:l,className:m=""})=>{const{personas:s,isLoading:d}=j(),[t,c]=o.useState(!1);if(d)return e.jsx("div",{className:`animate-pulse bg-gray-200 rounded-md h-10 ${m}`});const i=s.find(n=>n.id===a);return e.jsxs("div",{className:`relative ${m}`,children:[e.jsxs("button",{type:"button",onClick:()=>c(!t),className:`w-full flex items-center justify-between p-2 border rounded-md bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 transition-all ${t?"ring-2 ring-indigo-200 border-indigo-500":""}`,"aria-haspopup":"true","aria-expanded":t,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-700",children:i?i.nombre:"Seleccionar persona"}),i&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",i.email,")"]})]}),e.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${t?"transform rotate-180":""}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),t&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md py-1",children:s.map(n=>e.jsx("button",{onClick:()=>{l(n.id),c(!1)},className:`w-full text-left px-4 py-2 text-sm ${n.id===a?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:n.nombre}),e.jsx("span",{className:"text-sm text-gray-500",children:n.email})]})},n.id))})]})},S=()=>{const{agregarGasto:a,isLoading:l,personas:m}=j(),[s,d]=o.useState(!1),[t,c]=o.useState(50),[i,n]=o.useState(50),[u,h]=o.useState(""),[g,f]=o.useState(""),x=o.useRef(null);if(l)return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(w,{size:"large",color:"primary"})})});const v=async r=>{if(r.preventDefault(),!u){alert("Por favor selecciona una persona");return}if(s&&!g){alert("Por favor ingresa el email de la otra persona");return}const p=new FormData(r.currentTarget),b={mes:p.get("mes"),descripcion:p.get("descripcion"),monto:Number(p.get("monto")),personaid:u,escompartido:s,porcentajepersona1:s?t:100,porcentajepersona2:s?i:0,otraPersonaEmail:s?g:null};console.log("Nuevo gasto:",b);try{await a(b),x.current&&x.current.reset(),h(""),d(!1),c(50),n(50),f("")}catch(N){console.error("Error al agregar gasto:",N)}};return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsxs("form",{ref:x,onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"monto",className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto"}),e.jsx("input",{type:"number",id:"monto",name:"monto",step:"0.01",min:"0",required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"descripcion",className:"block text-sm font-medium text-gray-700 mb-1",children:"DescripciÃ³n"}),e.jsx("input",{type:"text",id:"descripcion",name:"descripcion",required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mes"}),e.jsxs("select",{id:"mes",name:"mes",required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all",children:[e.jsx("option",{value:"enero",children:"Enero"}),e.jsx("option",{value:"febrero",children:"Febrero"}),e.jsx("option",{value:"marzo",children:"Marzo"}),e.jsx("option",{value:"abril",children:"Abril"}),e.jsx("option",{value:"mayo",children:"Mayo"}),e.jsx("option",{value:"junio",children:"Junio"}),e.jsx("option",{value:"julio",children:"Julio"}),e.jsx("option",{value:"agosto",children:"Agosto"}),e.jsx("option",{value:"septiembre",children:"Septiembre"}),e.jsx("option",{value:"octubre",children:"Octubre"}),e.jsx("option",{value:"noviembre",children:"Noviembre"}),e.jsx("option",{value:"diciembre",children:"Diciembre"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"persona",className:"block text-sm font-medium text-gray-700 mb-1",children:"Persona"}),e.jsx(P,{value:u,onChange:r=>h(r),className:"w-full"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"shared",name:"shared",checked:s,onChange:r=>d(r.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"shared",className:"text-sm text-gray-700",children:"Gasto compartido"})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otraPersonaEmail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email de la otra persona"}),e.jsx("input",{type:"email",id:"otraPersonaEmail",name:"otraPersonaEmail",value:g,onChange:r=>f(r.target.value),required:s,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all",placeholder:"ejemplo@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"percentage1",className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje Persona 1"}),e.jsx("input",{type:"number",id:"percentage1",name:"percentage1",min:"0",max:"100",value:t,onChange:r=>c(parseInt(r.target.value)),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"percentage2",className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje Persona 2"}),e.jsx("input",{type:"number",id:"percentage2",name:"percentage2",min:"0",max:"100",value:i,onChange:r=>n(parseInt(r.target.value)),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 outline-none transition-all"})]})]}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",children:"Agregar Gasto"})]})})},z=()=>{const[a,l]=o.useState(!1);return o.useEffect(()=>{l(!0)},[]),a?e.jsx(y,{children:e.jsx(S,{})}):e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"inline-block animate-spin w-12 h-12 text-indigo-600",children:e.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})})})};export{z as AddGastoFormWrapper};
